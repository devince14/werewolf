# 狼人杀智能体比赛平台 - 使用说明

## 🚀 快速启动

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **启动平台**
   ```bash
   python app.py
   ```

3. **访问平台**
   打开浏览器访问：`http://localhost:5000`

## 👥 多用户使用

### 支持的用户数量
- ✅ **3-5人同时使用** - 完全支持
- ✅ **同时注册、登录** - 无问题
- ✅ **同时浏览页面** - 无问题
- ✅ **同时提交代码** - 支持，评测会排队

### 使用流程
1. 用户注册账号
2. 登录平台
3. 编写智能体代码
4. 提交评测（等待1-2分钟）
5. 查看结果和排行榜

## 📊 功能特性

### 用户管理
- ✅ 用户注册和登录
- ✅ 个人资料管理
- ✅ 密码安全存储

### 代码管理
- ✅ 在线代码编辑器
- ✅ 代码模板加载
- ✅ 代码版本保存
- ✅ 历史代码查看

### 评测系统
- ✅ 自动代码评测
- ✅ 多角色胜率统计
- ✅ 详细评测报告
- ✅ 排行榜功能

### 数据安全
- ✅ 用户数据隔离
- ✅ 代码文件独立存储
- ✅ 权限控制

## 🔧 技术架构

### 后端
- **Flask** - Web框架
- **SQLAlchemy** - 数据库ORM
- **SQLite** - 数据库
- **Flask-Login** - 用户认证

### 前端
- **HTML/CSS/JavaScript** - 基础界面
- **Monaco Editor** - 代码编辑器
- **响应式设计** - 支持移动端

### 评测环境
- **PettingZoo** - 多智能体环境
- **自定义狼人杀环境** - 游戏逻辑
- **异步评测** - 不阻塞用户界面

## 📁 文件结构

```
competition_template/
├── app.py                 # 主应用文件
├── models.py              # 数据库模型
├── forms.py               # 表单定义
├── evaluate_submission.py # 评测脚本
├── requirements.txt       # 依赖包
├── templates/             # 网页模板
├── agents_user/           # 用户代码存储
├── werewolf_env/          # 游戏环境
└── agents/                # 官方智能体
```

## 🎮 游戏规则

### 角色分配
- 1个狼人
- 1个预言家  
- 3个村民
- 总共5个玩家

### 游戏流程
1. **发言阶段** - 玩家可以声称身份
2. **投票阶段** - 投票处决一名玩家
3. **夜晚阶段** - 狼人杀人，预言家查验
4. **重复直到游戏结束**

### 胜利条件
- **狼人阵营**：狼人存活且村民阵营人数≤狼人阵营
- **村民阵营**：消灭所有狼人

## 📈 评测指标

### 胜率统计
- **总体胜率** - 所有角色的平均胜率
- **狼人胜率** - 扮演狼人时的胜率
- **预言家胜率** - 扮演预言家时的胜率
- **村民胜率** - 扮演村民时的胜率

### 评测设置
- 每场评测10000局游戏
- 随机分配角色
- 与官方BeliefAgent对战

## 🛠️ 故障排除

### 常见问题

1. **启动失败**
   - 检查Python版本（需要3.8+）
   - 检查依赖包是否安装完整
   - 检查端口5000是否被占用

2. **评测失败**
   - 检查代码语法是否正确
   - 检查是否实现了UserAgent类
   - 检查act方法返回值格式

3. **数据库错误**
   - 删除instance/werewolf_competition.db
   - 重新运行python app.py


## 🔮 未来扩展

如果用户数量增长，可以考虑：
1. 使用Gunicorn + 多进程
2. 数据库升级到PostgreSQL
3. 添加Redis缓存
4. 使用消息队列处理评测

但对于当前需求，现有版本完全够用！